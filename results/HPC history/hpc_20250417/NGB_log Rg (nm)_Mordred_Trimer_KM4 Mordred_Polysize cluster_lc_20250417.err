Traceback (most recent call last):
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 84, in <module>
    main_structural_numerical(
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 47, in main_structural_numerical
    scores, predictions  = train_ood_learning_curve(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 57, in train_ood_learning_curve
    score, predictions = prepare_data(
                         ^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 107, in prepare_data
    return run_ood_learning_curve(X, y,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 191, in run_ood_learning_curve
    test_score, train_scores, y_test_pred_ood, y_test_uncertainty = train_and_predict_ood(regressor,X_train, y_train,X_test, y_test,
                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/scoring.py", line 489, in train_and_predict_ood
    regressor.fit(X_train_val, y_train_val)
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/compose/_target.py", line 293, in fit
    self.regressor_.fit(X, y_trans, **routed_params.regressor.fit)
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 254, in fit
    return self.partial_fit(
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 431, in partial_fit
    proj_grad = self.fit_base(X_batch, grads, weight_batch)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 168, in fit_base
    models = [clone(self.Base).fit(X, g) for g in grads.T]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 168, in <listcomp>
    models = [clone(self.Base).fit(X, g) for g in grads.T]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/tree/_classes.py", line 1404, in fit
    super()._fit(
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/tree/_classes.py", line 472, in _fit
    builder.build(self.tree_, X, y, sample_weight, missing_values_in_feature_mask)
KeyboardInterrupt
Traceback (most recent call last):
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 84, in <module>
    main_structural_numerical(
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 47, in main_structural_numerical
    scores, predictions  = train_ood_learning_curve(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 57, in train_ood_learning_curve
    score, predictions = prepare_data(
                         ^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 107, in prepare_data
    return run_ood_learning_curve(X, y,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 191, in run_ood_learning_curve
    test_score, train_scores, y_test_pred_ood, y_test_uncertainty = train_and_predict_ood(regressor,X_train, y_train,X_test, y_test,
                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/scoring.py", line 489, in train_and_predict_ood
    regressor.fit(X_train_val, y_train_val)
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/compose/_target.py", line 293, in fit
    self.regressor_.fit(X, y_trans, **routed_params.regressor.fit)
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 254, in fit
    return self.partial_fit(
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 431, in partial_fit
    proj_grad = self.fit_base(X_batch, grads, weight_batch)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 173, in fit_base
    fitted = np.array([m.predict(X) for m in models]).T
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/ngboost/ngboost.py", line 173, in <listcomp>
    fitted = np.array([m.predict(X) for m in models]).T
                       ^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/tree/_classes.py", line 530, in predict
    X = self._validate_X_predict(X, check_input)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/tree/_classes.py", line 489, in _validate_X_predict
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/usrapps/ddomlab/sdehgha2/gpu-env/lib/python3.11/site-packages/sklearn/utils/_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Traceback (most recent call last):
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 85, in <module>
    main_structural_numerical(
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 47, in main_structural_numerical
    scores, predictions  = train_ood_learning_curve(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 57, in train_ood_learning_curve
    score, predictions = prepare_data(
                         ^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 107, in prepare_data
    return run_ood_learning_curve(X, y,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 155, in run_ood_learning_curve
    learning_curve_scores[f'CO_{cluster}'][f'Cluster size'] = len(X_tv)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
KeyError: 'CO_0'
Traceback (most recent call last):
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 85, in <module>
    main_structural_numerical(
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/hpc_submit_training_Rh/../make_ood_learning_curve.py", line 47, in main_structural_numerical
    scores, predictions  = train_ood_learning_curve(
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 57, in train_ood_learning_curve
    score, predictions = prepare_data(
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 107, in prepare_data
    return run_ood_learning_curve(X, y,
  File "/gpfs_common/share03/ddomlab/sdehgha2/working-space/main/P1_pls-dataset/pls-dataset-space/PLS-Dataset/code_/training/get_ood_split_learning_curve.py", line 155, in run_ood_learning_curve
    learning_curve_scores[f'CO_{cluster}'][f'Cluster size'] = len(X_tv)
KeyError: 'CO_0'
